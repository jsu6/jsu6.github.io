<!doctype html>
<html lang="en">
<meta charset="utf-8">
<title>Notification API Fingerprinting Demo (Educational)</title>
<body style="font-family:system-ui;padding:1rem;white-space:pre-wrap">
<h2>Notification API Fingerprinting Demo</h2>
<p>This educational demo checks which Notification API features exist in your browser,
counts how many return <b>true</b> or <b>false</b>, and shows the current permission state.
No data leaves your device.</p>

<button id="run">Run Demo</button>
<pre id="out">Ready...</pre>

<script>
const log = (...a) => out.textContent += a.join(' ') + '\n';

document.getElementById('run').onclick = async () => {
  out.textContent = '';
  log('[Notification API Inspection]');
  log('Checking feature support...\n');

  const props = [
    'maxActions', 'permission', 'requestPermission',
    'actions', 'badge', 'body', 'dir', 'icon', 'image',
    'lang', 'renotify', 'requireInteraction', 'showTrigger',
    'silent', 'tag', 'timestamp', 'title', 'vibrate'
  ];

  let trueCount = 0, falseCount = 0;

  for (const p of props) {
    const supported = (p in Notification) || (p in Notification.prototype);
    log(`${p.padEnd(20)} : ${supported}`);
    if (supported) trueCount++;
    else falseCount++;
  }

  log('\n[Summary]');
  log(`Supported (true): ${trueCount}`);
  log(`Unsupported (false): ${falseCount}`);
  log(`Total checked: ${props.length}\n`);

  log('[Feature values]');
  log('maxActions =', Notification.maxActions);
  log('permission =', Notification.permission);

  // --- Permission behavior ---
  if (Notification.permission !== 'granted') {
    try {
      const result = await Notification.requestPermission();
      log('requestPermission() ->', result);
    } catch(e) {
      log('Permission request error:', e.message);
    }
  } else {
    log('Already granted.');
  }

  // --- Create a local notification (no remote data) ---
  if (Notification.permission === 'granted') {
    const n = new Notification('Fingerprint Demo', {
      body: 'Testing Notification rendering',
      icon: 'https://via.placeholder.com/64',
      image: 'https://via.placeholder.com/128',
      tag: 'demoTag',
      vibrate: [100,50,100],
      requireInteraction: true,
      renotify: true,
      timestamp: Date.now()
    });

    n.onshow = () => log('[onshow] Notification displayed');
    n.onclick = () => log('[onclick] Notification clicked');
    n.onclose = () => log('[onclose] Notification closed');
    n.onerror = e => log('[onerror]', e.message);
  } else {
    log('Notification not shown because permission was not granted.');
  }

  // --- Environment-based variations ---
  log('\n[Environment signals]');
  log('navigator.platform:', navigator.platform);
  log('navigator.userAgent:', navigator.userAgent);
  log('Device vibration support:', 'vibrate' in Notification.prototype);
  log('Language direction support (dir):', 'dir' in Notification.prototype);
  log('Supports showTrigger (scheduled):', 'showTrigger' in Notification.prototype);

  log('\nDemo complete. Compare true/false counts across browsers/OS to see feature differences.');
};
</script>
</body>
</html>
