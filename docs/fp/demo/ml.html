<!doctype html>
<html>
<body>
<button id="run">run</button>
<pre id="out"></pre>

<script>
const out = document.getElementById("out");

async function run() {
  out.textContent = "";

  if (!navigator.ml) {
    out.textContent = "WebNN is not available.";
    return;
  }

  // Create context
  const ctx = await navigator.ml.createContext();

  // Create builder
  const b = new MLGraphBuilder(ctx);

  // --- Operand descriptor (must use shape + dataType)
  const desc = { dataType: "float32", shape: [4] };

  // --- Inputs
  const a = b.input("a", desc);
  const b2 = b.input("b", desc);

  // --- Computation: y = relu(a + b)
  const sum  = b.add(a, b2);
  const relu = b.relu(sum);

  // --- Build graph
  const graph = await b.build({ y: relu });

  // --- Prepare data
  const A = new Float32Array([1, -2, 3, -4]);
  const B = new Float32Array([0.5, 0.5, 0.5, 0.5]);
  const Y = new Float32Array(4);

  // --- Execute
  await ctx.compute(graph, { a: A, b: B }, { y: Y });

  // --- Output
  out.textContent = "output: [" + Array.from(Y).join(", ") + "]";
}

document.getElementById("run").onclick = run;
</script>
</body>
</html>
