<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Web Animations Inspector</title>
  <style>
    body {
      font-family: system-ui, sans-serif;
      padding: 1.5rem;
      background: #f5f5f5;
    }
    #box {
      width: 80px;
      height: 80px;
      background: #4a90e2;
      border-radius: 8px;
      margin-bottom: 1rem;
    }
    #controls {
      margin-bottom: 1rem;
    }
    button {
      margin-right: 0.5rem;
      padding: 0.25rem 0.75rem;
      cursor: pointer;
    }
    pre {
      background: #111;
      color: #eee;
      padding: 1rem;
      border-radius: 8px;
      max-height: 400px;
      overflow: auto;
      font-size: 0.85rem;
    }
  </style>
</head>
<body>
  <h1>Web Animations Inspector (for debugging)</h1>

  <div id="box"></div>

  <div id="controls">
    <button id="play">Play</button>
    <button id="pause">Pause</button>
    <button id="reverse">Reverse</button>
    <button id="faster">2x Speed</button>
    <button id="normal">1x Speed</button>
    <button id="finish">Finish</button>
  </div>

  <pre id="output">(waiting for animation...)</pre>

  <script>
    const box = document.getElementById('box');
    const output = document.getElementById('output');

    // Create an animation on the box
    const animation = box.animate(
      [
        { transform: 'translateX(0px)',   background: '#4a90e2' },
        { transform: 'translateX(300px)', background: '#e94e77' }
      ],
      {
        duration: 2000,
        iterations: Infinity,
        direction: 'alternate',
        easing: 'ease-in-out'
      }
    );

    // Give the animation an id
    animation.id = 'demo-animation';

    // Convenience: get timeline time using either property or method
    function getTimelineCurrentTime(timeline) {
      if (!timeline) return null;
      if (typeof timeline.currentTime === 'number' || timeline.currentTime === null) {
        return timeline.currentTime;
      }
      if (typeof timeline.getCurrentTime === 'function') {
        return timeline.getCurrentTime();
      }
      return null;
    }

    function updateDisplay() {
      const effect = animation.effect;
      const timing = effect ? effect.getTiming() : null;
      const computedTiming = effect ? effect.getComputedTiming() : null;
      const timeline = document.timeline || animation.timeline;

      // "Animation.progress" is not a standard property, but the computed
      // timing info exposes a progress field we can show:
      const progressFromComputed = computedTiming ? computedTiming.progress : null;

      const info = {
        'Animation.id': animation.id,
        'Animation.playState': animation.playState,
        'Animation.currentTime': animation.currentTime,
        'Animation.startTime': animation.startTime,
        'Animation.playbackRate (via updatePlaybackRate)': animation.playbackRate,
        'Animation.timeline current time (AnimationTimeline.getCurrentTime)': getTimelineCurrentTime(timeline),
        'Animation.progress (from getComputedTiming().progress)': progressFromComputed,
        'Animation.effect exists': !!effect,
        'AnimationEffect.getTiming()': timing,
        'AnimationEffect.getComputedTiming()': computedTiming
      };

      let text = '';
      for (const [key, value] of Object.entries(info)) {
        if (value && typeof value === 'object') {
          text += `${key}:\n${JSON.stringify(value, null, 2)}\n\n`;
        } else {
          text += `${key}: ${value}\n`;
        }
      }

      output.textContent = text;

      requestAnimationFrame(updateDisplay);
    }

    // Set up controls
    document.getElementById('play').addEventListener('click', () => {
      animation.play();
    });

    document.getElementById('pause').addEventListener('click', () => {
      animation.pause();
    });

    document.getElementById('reverse').addEventListener('click', () => {
      animation.reverse();
    });

    document.getElementById('faster').addEventListener('click', () => {
      animation.updatePlaybackRate(animation.playbackRate * 2);
    });

    document.getElementById('normal').addEventListener('click', () => {
      animation.updatePlaybackRate(1);
    });

    document.getElementById('finish').addEventListener('click', () => {
      // Jump to the end of the current active interval
      animation.finish();
    });

    // Start updating the display
    requestAnimationFrame(updateDisplay);
  </script>
</body>
</html>
