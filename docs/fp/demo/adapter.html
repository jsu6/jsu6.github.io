<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Simple WebGPU Adapter Dump</title>
</head>
<body>
<pre id="out">Runningâ€¦</pre>

<script type="module">
async function main() {
  const out = document.getElementById('out');
  out.textContent = '';

  function log(...args) {
    console.log(...args);
    out.textContent += args.join(' ') + '\n';
  }

  if (!('gpu' in navigator)) {
    log('WebGPU not supported (navigator.gpu is undefined).');
    return;
  }

  const adapter = await navigator.gpu.requestAdapter();
  if (!adapter) {
    throw Error("Couldn't request WebGPU adapter.");
  }

  // =========================================================
  // adapter.info  (your style)
  // =========================================================
  let adapterInfo = adapter.info;

  // If adapter.info is not present, try requestAdapterInfo()
  if (!adapterInfo && typeof adapter.requestAdapterInfo === 'function') {
    try {
      adapterInfo = await adapter.requestAdapterInfo([
        "vendor",
        "architecture",
        "device",
        "description"
      ]);
    } catch (e) {
      log('requestAdapterInfo() failed:', e);
    }
  }

  if (adapterInfo) {
    log('=== adapter.info ===');
    for (const [key, value] of Object.entries(adapterInfo)) {
      log(`info.${key}:`, value);
    }
  } else {
    log('adapter.info is not available');
  }

  // =========================================================
  // adapter.features
  // =========================================================
  log('\n=== adapter.features ===');
  try {
    for (const feature of adapter.features) {
      log('feature:', feature);
    }
  } catch (e) {
    log('Error reading adapter.features:', e);
  }

  // =========================================================
  // adapter.limits
  // =========================================================
  log('\n=== adapter.limits ===');
  try {
    for (const key of Object.keys(adapter.limits)) {
      log(`limit.${key}:`, adapter.limits[key]);
    }
  } catch (e) {
    log('Error reading adapter.limits:', e);
  }
}

main().catch(err => {
  console.error(err);
  const out = document.getElementById('out');
  out.textContent += '\nERROR: ' + err;
});
</script>
</body>
</html>
