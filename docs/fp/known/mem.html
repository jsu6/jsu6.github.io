<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Performance.memory Demo</title>
  <style>
    body { font-family: monospace; padding: 1.5em; background: #f7f7f7; }
    pre { background: #fff; padding: 1em; border-radius: 8px; box-shadow: 0 1px 4px rgba(0,0,0,0.1); }
    button { padding: .4em .8em; margin-top: .8em; }
  </style>
</head>
<body>
  <h2>Performance.memory</h2>
  <div id="output"><pre>Loading...</pre></div>
  <button id="refresh">Refresh</button>
  <button id="auto">Start Auto Update</button>

  <script>
    const outEl = document.getElementById('output');
    const refreshBtn = document.getElementById('refresh');
    const autoBtn = document.getElementById('auto');
    let autoTimer = null;

    function getMemoryInfo() {
      if (!('memory' in performance)) {
        outEl.innerHTML = `<pre>performance.memory not supported in this browser.</pre>`;
        return;
      }

      const mem = performance.memory;
      const info = {
        totalJSHeapSize: mem.totalJSHeapSize,
        usedJSHeapSize: mem.usedJSHeapSize,
        jsHeapSizeLimit: mem.jsHeapSizeLimit
      };

      const percentUsed = ((mem.usedJSHeapSize / mem.jsHeapSizeLimit) * 100).toFixed(2) + '%';

      outEl.innerHTML = `<pre>${JSON.stringify(info, null, 2)}\n\nHeap usage: ${percentUsed}</pre>`;
    }

    refreshBtn.addEventListener('click', getMemoryInfo);

    autoBtn.addEventListener('click', () => {
      if (autoTimer) {
        clearInterval(autoTimer);
        autoTimer = null;
        autoBtn.textContent = 'Start Auto Update';
      } else {
        getMemoryInfo();
        autoTimer = setInterval(getMemoryInfo, 2000);
        autoBtn.textContent = 'Stop Auto Update';
      }
    });

    getMemoryInfo(); // initial
  </script>
</body>
</html>
